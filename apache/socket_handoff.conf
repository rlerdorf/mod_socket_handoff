# mod_socket_handoff configuration
#
# This module allows PHP (or any handler) to hand off client connections
# to an external daemon by setting response headers.
#
# Headers:
#   X-Socket-Handoff: /path/to/unix/socket
#   X-Handoff-Data: optional JSON data to pass to daemon

# Enable the filter
SocketHandoffEnabled On

# Security: Only allow sockets under this path prefix
# The module will reject any socket path that doesn't start with this prefix
SocketHandoffAllowedPrefix /var/run/

# Timeout (ms) for connecting to the handoff daemon socket
# Valid range: 1-60000 (1ms to 60 seconds)
# For high-traffic deployments, consider lowering to 100-200ms
SocketHandoffConnectTimeoutMs 500

# Timeout (ms) for sending the fd to the daemon via sendmsg()
# Uses SO_SNDTIMEO to prevent blocking when daemon socket buffer is full
# Critical for production to prevent Apache worker starvation
# Valid range: 1-60000 (1ms to 60 seconds)
SocketHandoffSendTimeoutMs 500

# Number of retries for transient connection errors (ENOENT, ECONNREFUSED)
# Helps during daemon restarts - uses exponential backoff (10ms, 20ms, 40ms, ...)
# Set to 0 to disable retries
# Valid range: 0-10
SocketHandoffMaxRetries 3
